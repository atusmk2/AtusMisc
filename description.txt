Random ideas and implementation. Mostly copy pasted from example mod.